<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Name Surname">
    <link rel="icon" href="media/favicon.ico">

    <title>Fab Academy 2015 - Sabina Barcucci</title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
  <link href="media/fabacademy.css" rel="stylesheet">       <link href="media/SABINA.css" rel="stylesheet">     <link href='http://fonts.googleapis.com/css?family=Karla:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
    
    <!-- 3D files viewer -->
    <script type="text/javascript" src="media/jsc3d_ie.min.js"></script>
	<script type="text/javascript" src="media/jsc3d.min.js"></script>
    <script type="text/javascript" src="media/jsc3d.webgl.js"></script>
    <script type="text/javascript" src="media/jsc3d.touch.js"></script>

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="bootstrap/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="bootstrap/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <!-- Load the menu file -->
    <script>
	function menu() {
					  $('#exercises').load("exercises-menu.html");
					  $('#project').load("project-menu.html");
					  $('#cclicense').load("license.html");
					  }
	</script>

  </head>

  <body onload="menu()">

    <!-- Static navbar -->
    <nav class="navbar navbar-default navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">Sabina Barcucci</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="about.html">About</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Exercises <span class="caret"></span></a>
              <ul id="exercises" class="dropdown-menu" role="menu">
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Breathing Pod <span class="caret"></span></a>
              <ul id="project" class="dropdown-menu" role="menu">
              </ul>
            </li>
            <li><a href="contact.html">Contact</a></li>
        </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">

	<!-- Insert your content here below! -->
 <h2><strong>Networking and Communication</strong></h1>
        <h3>FabKit Serial Communication</h3> 
        Weekly assignment: design and build a wired &/or wireless network connecting at least two processors. <br>
        For this assignment I went for making a FabKit 0.4 and to connect it with another fabKit via serial communication. <br><br>
        
        <img src="img13/serial_communication_FabKit.jpg"/></a> <br><br>
         <h3>1) Making a FabKit 0.4</h3>
      I decided to make, solder and program a FabKit, an Arduino-compatible board designed by David Mellis and based on an ATMEGA382P microcontroller, because this board will be useful for my final project. I started following this tutorial <a href="http://fabacademy.org/archives/2015/doc/projects/fabkit-0.4.html">this tutorial on FabKit 0.4 by Massimo Menichinelli</a> where I could donwload the several files to understand it, make it, stuff it and wire it. <br> <br>
      
      <a href="img13/FabKit_0.4_eagle_files.zip">
      <button type="button" class="btn btn-primary btn-lg">Grab FabKit0.4 eagle files</button> </a><br> <br>
      
      <a href="img13/FabKit_0.4_png_files.zip">
    <button type="button" class="btn btn-primary btn-lg">Grab FabKit0.4 png files</button> </a><br> <br>
      To make the board, I have been at <a href="http://www.opendotlab.it/">OpenDot FabLab</a> to use their lasercutter, a Trotec Speedy 100 flexx. The flexx line of laser cutters has both CO2 and fiber laser technologies: 60 watt CO2 laser, 30 watt fiber laser. <br><br>
      
      
 Below you find a description of the laser settings from this <a href="http://fabacademy.org/archives/2015/doc/fiber-laser-cutting-pcb.html">OpenDot tutorial</a>: <br><br>
    
      <img src="img13/FR1_settings_Trotec.jpg"/></a> <br><br>
    <img src="img13/fabkit_colors.jpg"/></a> <br><br>
      <blockquote cite="http://fabacademy.org/archives/2015/doc/fiber-laser-cutting-pcb.html">
The black color is used for the first pass, and it is needed for engraving the copper away (otherwise we cannot cut the FR1 board). These are the settings:

Type: fiber laser.
Power: 80.00.
Speed: 20.00.
PPI/Hz: 20000.
Passes: 9.
Advanced:
Correction: 10.
High quality: yes.
Raster correction: yes.
The red color is used for the second pass, for cutting the holes in the FR1 board. These are the settings:

Type: CO2.
Power: 50.00.
Speed: 0.60.
PPI/Hz: 5000.
Passes: 3.
Advanced: Default
The blue color is used for the third pass, for cutting the border in the FR1 board. These are the settings:

Type: CO2.
Power: 80.00.
Speed: 0.60.
PPI/Hz: 5000.
Passes: 2.
Advanced: Default
</blockquote>
      
      <img src="img13/trotec_fiber_laser.jpg"/></a> <br><br>

Then I soldered the board, using the Bill of Material below reported. 
      
        <pre class="prettyprint linenums">
<h3>FabKit 0.4 BOM</h3> 
-C1 .1uf C-EUC1206 C1206 CAPACITOR, European symbol
399-4674-1-ND 
http://www.digikey.it/product-detail/it/C1206C104KARACTU/399-4674-1-ND/992199
-C2 1uf UNPOLARIZED_CAPACITOR1206 unpolarized_capacitor
445-1423-1-ND
http://www.digikey.it/product-detail/it/C3216X7R1H105K160AB/445-1423-1-ND/569089
- C3 .1uf UNPOLARIZED_CAPACITOR1206 unpolarized_capacitor
399-4674-1-ND
http://www.digikey.it/product-detail/it/C1206C104KARACTU/399-4674-1-ND/992199
- C4 10uf UNPOLARIZED_CAPACITOR1206 unpolarized_capacitor
587-1352-1-ND
http://www.digikey.it/product-detail/it/GMK316F106ZL-T/587-1352-1-ND/931129
- IC1 ATMEGA48/88/168-AU
TQFP32-08 ATMEGA328P-AU-ND
http://www.digikey.it/product-detail/it/ATMEGA328P-AU/ATMEGA328P-AU-ND/1832260
- JP1 M06SMD 1X06-SMD Header 6 SAM1043-06-ND
http://www.digikey.it/product-detail/it/TSW-106-08-L-S-RA/SAM1043-06-ND/1102018
 - LED1206 LED YELLOW ORANGE CLEAR 1206 SMD
160-1403-1-ND
http://www.digikey.it/product-search/it?KeyWords=160-1403-1-ND%09&WT.z_header=search_go
- PAD2 WIREPAD2,54/0,9
Wire PAD connect wire on PCB
-R1 10k RESISTOR1206 311-10.0KFRCT-ND
http://www.digikey.it/product-detail/it/RC1206FR-0710KL/311-10.0KFRCT-ND/731430
- R2 499 RESISTOR1206 311-499FRCT-ND
http://www.digikey.it/product-detail/it/RC1206FR-07499RL/311-499FRCT-ND/731891
- S1 6MM_SWITCH6MM_SWITCH OMRON SWITCH SW262CT-ND
http://www.digikey.it/product-detail/it/B3SN-3112P/SW262CT-ND/60835
- SV1 MA08-1 PIN HEADER S9016E-10-ND
http://www.digikey.it/product-detail/it/GRPB101VWCN-RC/S9016E-10-ND/1786473
- U$2 RESONATOREFOB EFOBM 535-10004-1-ND
http://www.digikey.it/product-detail/it/AWSCR-8.00CV-T/535-10004-1-ND/2001627
</pre>

I was quite scared of soldering the microcontroller, since the several pins to solder and their super tiny dimensions. Actually, this was quite easy, fast and surprisingly clean. <br><br>

<img src="img13/fabkit_soldering.jpg"/></a> <br><br>

<h3>2) Programming a FabKit 0.4</h3>

Always in <a href="http://fabacademy.org/archives/2015/doc/projects/fabkit-0.4.html">this tutorial</a>, I found instructions on how to program the FabKit using the Arduino IDE. <br><br>
First I added this text to the boards.txt files of the arduino application installed in my computer. 

<pre class="prettyprint linenums">
##############################################################

fabduino.name=Fabkit/Fabduino w/ ATmega328 (internal clock)

fabduino.upload.protocol=stk500v1
fabduino.upload.maximum_size=14336
fabduino.upload.speed=19200

fabduino.bootloader.low_fuses=0xe2
fabduino.bootloader.high_fuses=0xdd
fabduino.bootloader.extended_fuses=0x00
fabduino.bootloader.path=arduino:atmega
fabduino.bootloader.file=atmega/ATmegaBOOT_168_atmega328_pro_8MHz.hex
fabduino.bootloader.unlock_bits=0x3F
fabduino.bootloader.lock_bits=0x0F

fabduino.build.mcu=atmega328p
fabduino.build.f_cpu=8000000L

fabduino.build.core=arduino:arduino
fabduino.build.variant=arduino:standard

fabduino.upload.tool=arduino:avrdude
fabduino.bootloader.tool=arduino:avrdude
</pre>
Once that was done, I could find in my arduino IDE a new board, the FabKit, among the others. <br>
<img src="img13/type_of_arduino.jpg"/></a> <br>
I selected USBtinyISP as programmer since I used the FabISP to burn the booloader of the FabKit. <br>
<img src="img13/progammer.jpg"/></a> <br>

The IDE feedback when I tried to "burn the bootloader" was always reporting connection problem and I struggled for a while before understanding that the board was already programmable. I tried the simple blink sketch and it worked (better to keep the reset button pushed while the code is uploaded on the FabKit). <br><br>

Finally, I was ready to experiment with Networking and communication, connecting two FabKits to each other. 

    
        
        <h3>What is serial communication?</h3>
Embedded electronics is all about interlinking circuits (processors or other integrated circuits) to create a symbiotic system. In order for those individual circuits to swap their information, they must share a common communication protocol. Hundreds of communication protocols have been defined to achieve this data exchange, and, in general, each can be separated into one of two categories: parallel or serial.

Serial interfaces stream their data, one single bit at a time. These interfaces can operate on as little as one wire, usually never more than four.

A serial bus consists of just two wires - one for sending data and another for receiving. As such, serial devices should have two serial pins: the receiver, RX, and the transmitter, TX.<br><br>

<img src="img13/scheme000.jpg"/></a> <br><br>
It’s important to note that those RX and TX labels are with respect to the device itself. So the RX from one device should go to the TX of the other, and vice-versa. It’s weird if you’re used to hooking up VCC to VCC, GND to GND, MOSI to MOSI, etc., but it makes sense if you think about it. The transmitter should be talking to the receiver, not to another transmitter.<br><br>
<h3>FabKits Serial Bus Communication</h3> 
        <iframe width="640" height="480" src="https://www.youtube.com/embed/-O7YasFL6B4" frameborder="0" allowfullscreen></iframe>
<br><br>
      It is possible to chain FabKits together in such a way as to get communication between the two. Having FabKit-FabKit communication can be useful for many projects, such as having one FabKit to run motors and having another sense the surroundings and then relay commands to the other FabKit. This can be done in several methods serial port, among others.<br><br>

I followed <a href="http://robotic-controls.com/learn/arduino/arduino-arduino-serial-communication">this</a> tutorial for the Networking and Communication assignment. It focuses on Arduino-Arduino communication through the serial ports (RX and TX). The Fritzing scheme below shows the simple connection among pcbs. Note that note that TX goes to RX and RX goes to TX. <br><br><br>
      
      <img src="img13/arduino_serial.jpg"/></a> <br>
     
To let the two FabKit communicate, I needed to prepare two sketches, the first sending a data (an input) to the second that had to give an output according to the data received: a first arduino as sender, and the second as receiver. When the FabKit sender sends via serial port "1", the FabKit receiver lights up a LED. When the sender sends a "0", the receiver shut down the LED. <br><br>

    <img src="img13/IDE_tx_rx.jpg"/></a> <br><br>



<h3>Sender</h3>
	<p>The
	FabKit sender sketch:
	<pre class="prettyprint linenums">
// Arduino send data to serial to another Arduino

void setup() {
  // initialize
  Serial.begin(9600);
}

void loop() {
  Serial.print('0');
  delay(100);
  Serial.print('1');
  delay(100);

}</pre>
     
    <h3>Receiver</h3>
	<p>The
	FabKit receiver sketch:
	<pre class="prettyprint linenums">
// Arduino read data from serial from another Arduino

const int ledPin =  13;      // the number of the LED pin

char data;

void setup() {
  // initialize
  pinMode(ledPin, OUTPUT);
  Serial.begin(9600);
}

void loop() {
  data = Serial.read();
  
  if (data == '1') {
    digitalWrite(ledPin, HIGH);
    // Debug if the data check works
    Serial.print("ok");
} else {
 digitalWrite(ledPin, LOW);
  }
  delay(100);
}</pre>

 <h3>FabKits power supply</h3> 
      <img src="img13/FabKit_Power_supply.jpg"/></a> <br>
	</p>
	
	
    <!-- End of your content -->

    </div> <!-- /container -->

	<!-- footer -->
    
    <footer id="footer">
        <p id="cclicense">
                </p>
        <p class="license">
        Theme: <a href="https://github.com/openp2pdesign/FabAcademy_Template">Fab Academy Template</a> by <a href="http://openp2pdesign.org">Massimo Menichinelli</a>modified by Sabina Barcucci  <br>
        Based on <a href="http://getbootstrap.com/">Twitter Bootstrap</a>+<a href="http://jquery.com/">JQuery</a>+<a href="https://code.google.com/p/google-code-prettify/">google-code-prettify</a>+<a href="http://jmblog.github.io/color-themes-for-google-code-prettify/github/">GitHub theme for google-code-prettify</a>+<a href="https://code.google.com/p/jsc3d/">JSC3D</a>+<a href="https://github.com/thegrubbsian/jquery.ganttView">jquery.ganttView</a>.
        </p>
    </footer>
    

	<!-- Do not touch this! -->
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="media/jquery-1.9.1.min.js"></script>
    
    <!-- Syntax Highlighter -->
    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js">
    </script>
    <!-- From https://github.com/jmblog/color-themes-for-google-code-prettify -->
    <link href="media/github.css" type="text/css" rel="stylesheet">
	<script type="text/javascript">
	  !function ($) {
		$(function(){
		  window.prettyPrint && prettyPrint()   
		})
	  }(window.jQuery)
	</script>
	
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="bootstrap/js/ie10-viewport-bug-workaround.js"></script>

  </body>
</html>
